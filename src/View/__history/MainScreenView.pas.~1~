unit MainScreenView;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Vcl.StdCtrls,
  Vcl.Imaging.pngimage;

type
  TfrmMainScreen = class(TForm)
    pnlMainScreenBackground: TPanel;
    pnlLogoSystem: TPanel;
    ImgLogoSystem: TImage;
    lblNameSystem: TLabel;
    pnlBtnMenuItemProduct: TPanel;
    imgItemProduct: TImage;
    pnlBtnMenuItemProductTitle: TPanel;
    lblItemProduct: TLabel;
    pnlBtnMenuItemProductImage: TPanel;
    pnlBtnMenuItemClose: TPanel;
    pnlBtnMenuItemCloseTitle: TPanel;
    lblItemClose: TLabel;
    pnlBtnMenuItemCloseImage: TPanel;
    imgItemClose: TImage;
    pnlBtnMenuItemCustomer: TPanel;
    pnlBtnMenuItemCustomerTitle: TPanel;
    lblItemCustomer: TLabel;
    pnlBtnMenuItemCustomerImage: TPanel;
    imgItemCustomer: TImage;
    pnlSeparator: TPanel;
    Panel1: TPanel;
    Panel2: TPanel;
    Panel3: TPanel;
    procedure FormCreate(Sender: TObject);
  private
    procedure LinkEventsToButtons;
    procedure MenuItemMouseEnter(Sender: TObject);
    procedure MenuItemMouseLeave(Sender: TObject);
    procedure CloseApplication(Sender: TObject);
    function GetAssociatedLabel(Sender: TObject): TLabel;
  public
  end;

var
  frmMainScreen: TfrmMainScreen;

implementation

{$R *.dfm}

procedure TfrmMainScreen.CloseApplication;
begin
  Application.Terminate;
end;

procedure TfrmMainScreen.FormCreate(Sender: TObject);
begin
  LinkEventsToButtons;
  Self.Width := Screen.WorkAreaWidth;
  pnlMainScreenBackground.Width := Self.ClientWidth;
  pnlMainScreenBackground.Realign;
  Application.ProcessMessages;
end;

procedure TfrmMainScreen.LinkEventsToButtons;
begin
  imgItemProduct.OnMouseEnter := MenuItemMouseEnter;
  imgItemProduct.OnMouseLeave := MenuItemMouseLeave;
  lblItemProduct.OnMouseEnter := MenuItemMouseEnter;
  lblItemProduct.OnMouseLeave := MenuItemMouseLeave;

  imgItemCustomer.OnMouseEnter := MenuItemMouseEnter;
  imgItemCustomer.OnMouseLeave := MenuItemMouseLeave;
  lblItemCustomer.OnMouseEnter := MenuItemMouseEnter;
  lblItemCustomer.OnMouseLeave := MenuItemMouseLeave;

  imgItemClose.OnMouseEnter := MenuItemMouseEnter;
  imgItemClose.OnMouseLeave := MenuItemMouseLeave;
  imgItemClose.OnClick := CloseApplication;
  lblItemClose.OnMouseEnter := MenuItemMouseEnter;
  lblItemClose.OnMouseLeave := MenuItemMouseLeave;
  lblItemClose.OnClick := CloseApplication;
end;

function TfrmMainScreen.GetAssociatedLabel(Sender: TObject): TLabel;
begin
  Result := nil;
  if Sender = imgItemProduct then
    Result := lblItemProduct
  else if Sender = imgItemClose then
    Result := lblItemClose
  else if Sender = imgItemCustomer then
    Result := lblItemCustomer;
end;

procedure TfrmMainScreen.MenuItemMouseEnter(Sender: TObject);
var
  LabelControl: TLabel;
begin
  if Sender is TLabel then
    LabelControl := TLabel(Sender)
  else
    LabelControl := GetAssociatedLabel(Sender);

  if Assigned(LabelControl) then
  begin
    LabelControl.Font.Style := [fsBold, fsUnderline];
    LabelControl.Font.Size := 13;
  end;
end;

procedure TfrmMainScreen.MenuItemMouseLeave(Sender: TObject);
var
  LabelControl: TLabel;
begin
  if Sender is TLabel then
    LabelControl := TLabel(Sender)
  else
    LabelControl := GetAssociatedLabel(Sender);

  if Assigned(LabelControl) then
  begin
    LabelControl.Font.Style := [fsBold];
    LabelControl.Font.Size := 12;
  end;
end;

end.
